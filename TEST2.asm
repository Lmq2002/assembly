
DATA SEGMENT
	IS DB 20
	    DB ?
	    DB 20 DUP(?)
	BUF DB "INOUT AN INTERGER:",'$'
	OS DB 'THE SUM IS:$'
	OT DB 20 DUP(?),'$'
	CRLF DB 0AH,0DH,'$'

	INDEX DB 0	;下标
	INUM DB 0	;输入的数字100
	ONUM DW ?	;输出的数字5050
	OO DW ?		;余数
	NUM DB 0	;入栈个数
	
DATA ENDS

CODE SEGMENT
ASSUME CS:CODE,DS:DATA
START:
	MOV AX,DATA
	MOV DS,AX	;DS段是DATA址

	;MOV DX,OFFSET BUF	;输出DX指向的字符串
	LEA DX,BUF
	MOV AH,09H
	INT 21H		;输出BUF
	
	;CALL INPUT
	
	LEA DX,IS
	MOV AH,0AH
	INT 21H		;输入字符串，以回车结尾

	LEA DX,CRLF
	MOV AH,09H
	INT 21H		;回车	

	MOV DL,IS[1]	;字符串长度
	MOV AX,0	;数字
	LEA SI,IS[2]
	
MYADD:	
	MOV AL,INUM
	ADC AX,[SI]	;字符
	SUB AX,30H
	MOV INUM,AL
	
	MOV AH,INDEX
	MOV AL,IS[1]
	INC AH
	CMP AH,AL
	JE EXIT
	MOV INDEX,AH
	MOV AL,INUM
	MOV BL,0AH
	MUL BL
	INC SI
	MOV INUM,AL
	JMP MYADD	;字符串转为数字
EXIT:
	MOV DX,0
	MOV DL,INUM	;个数
	MOV CX,DX	;循环次数
	
LOOP1:
	MOV AX,ONUM
	ADC AX,DX
	MOV ONUM,AX
	SUB DL,1
	JNZ LOOP1	;循环累加


	LEA DX,CRLF
	MOV AH,09H
	INT 21H		;回车
	LEA DX,OS
	MOV AH,09H
	INT 21H		;输出提示


LOOP2:
	MOV DX,0
	MOV AX,ONUM	;被除数为32位
	MOV BX,0AH
	DIV BX		;除数为16位，AX商，DX余，余数入栈，商数循环

	CMP AX,0	;若已是最高位则跳转
	JE AA
	
	ADD DX,30H	;否则压栈
	PUSH DX
	MOV ONUM,AX
	MOV AL,NUM
	INC AL
	MOV NUM,AL
	JMP LOOP2
AA:	
	CMP DX,0	;输出最高位
	JE BB
	ADD DX,30H
	MOV AH,02H
	INT 21H
BB:
	MOV AL,NUM
	CMP AL,0		;当前栈是否为空
	JE FINAL
	SUB AL,1
	MOV NUM,AL
	POP DX
	MOV AH,02H
	INT 21H
	JMP BB

FINAL:
	MOV AH,4CH
	INT 21H	
CODE ENDS
END START